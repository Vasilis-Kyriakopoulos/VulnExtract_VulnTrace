Description,CVE_ID,label,CLBO,CLBU,CLNP,CLSF,CLOOA,CLUAF,CLCT,CLAV,CLIL,CLML,CLOBO,CLAC,CLDS,CLFR,CLTP
1,CVE-2013-0211,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
2,CVE-2013-0211,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
3,CVE-2013-0211,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
" ==28519==AddressSanitizer CHECK failed: ../../../../src/libsanitizer/sanitizer_common/sanitizer_posix.cc:66 ""((""unable to mmap"" && 0)) != (0)"" (0x0, 0x0) #0 0x7f415bfe5ba3 (/usr/lib/x86_64-linux-gnu/libasan.so.1+0x59ba3) #1 0x7f415bfe9ae3 in __sanitizer::CheckFailed(char const*, int, char const*, unsigned long long, unsigned long long) (/usr/lib/x86_64-linux-gnu/libasan.so.1+0x5dae3) #2 0x7f415bfee4c1 (/usr/lib/x86_64-linux-gnu/libasan.so.1+0x624c1) #3 0x7f415bfa89d8 (/usr/lib/x86_64-linux-gnu/libasan.so.1+0x1c9d8) #4 0x7f415bfe06f0 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.1+0x546f0) #5 0x46ed4e in __archive_read_filter_ahead libarchive/archive_read.c:1436 #6 0x46ed4e in __archive_read_ahead libarchive/archive_read.c:1303 #7 0x502611 in archive_read_format_cpio_read_header libarchive/archive_read_support_format_cpio.c:404 #8 0x46193d in _archive_read_next_header2 libarchive/archive_read.c:649 #9 0x46193d in _archive_read_next_header libarchive/archive_read.c:687 #10 0x4150f6 in read_archive tar/read.c:261 #11 0x4171c6 in tar_mode_t tar/read.c:94 #12 0x40b07d in main tar/bsdtar.c:803 #13 0x7f415b01bb44 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b44) #14 0x40dfbe (/usr/local/bin/bsdtar+0x40dfbe) This is caused when a corrupted cpio archive has a ridiculously large size for a symlink.",CVE-2016-4809,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
#0 0x7fbdb3b3ec1c in crc32_z (/lib/x86_64-linux-gnu/libz.so.1+0x2c1c) #1 0x84f5eb in header_bytes (/tmp/libarchive/bsdtar+0x84f5eb) #2 0x856156 in read_Header (/tmp/libarchive/bsdtar+0x856156) #3 0x84e134 in slurp_central_directory (/tmp/libarchive/bsdtar+0x84e134) #4 0x849690 in archive_read_format_7zip_read_header (/tmp/libarchive/bsdtar+0x849690) #5 0x5713b7 in _archive_read_next_header2 (/tmp/libarchive/bsdtar+0x5713b7) #6 0x570e63 in _archive_read_next_header (/tmp/libarchive/bsdtar+0x570e63) #7 0x6f08bd in archive_read_next_header (/tmp/libarchive/bsdtar+0x6f08bd) #8 0x52373f in read_archive (/tmp/libarchive/bsdtar+0x52373f) #9 0x5257be in tar_mode_x (/tmp/libarchive/bsdtar+0x5257be) #10 0x51daeb in main (/tmp/libarchive/bsdtar+0x51daeb) #11 0x7fbdb27cab96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310 #12 0x41dd09 in _start (/tmp/libarchive/bsdtar+0x41dd09) This was primarly done with afl and FairFuzz.,CVE-2019-1000019,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
#0 0x96c665 in archive_read_format_tar_skip /f/libarchive/libarchive/libarchive/archive_read_support_format_tar.c:612:2 #1 0x607044 in archive_read_data_skip /f/libarchive/libarchive/libarchive/archive_read.c:914:8 #2 0x515a49 in read_archive /f/libarchive/libarchive/tar/read.c:327:8 #3 0x510dbb in tar_mode_t /f/libarchive/libarchive/tar/read.c:96:2 #4 0x4feddc in main /f/libarchive/libarchive/tar/bsdtar.c:799:3 #5 0x7f183d686f9f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.20-r2/work/glibc-2.20/csu/libc-start.c:289 #6 0x442206 in _start (/f/libarchive/libarchive/bsdtar+0x442206) SUMMARY: AddressSanitizer: undefined-behavior libarchive/archive_read_support_format_tar.c:612 bsdtar: (null) bsdtar: Error exit delayed from previous errors.,CVE-2015-8933,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"(Each byte would get expanded to a four-charcter octal-style escape of the form ""\123"" resulting in >20 characters for the >5 byte multibyte character.)",CVE-2016-8687,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
(in /lib/x86_64-linux-gnu/liblzma.so.5.2.2) ==619== by 0x54C52E2: lzma_alone_decoder (in /lib/x86_64-linux-gnu/liblzma.so.5.2.2) ==619== by 0x14EEAC: zipx_lzma_alone_init (archive_read_support_format_zip.c:1455) ==619== by 0x14EEAC: zip_read_data_zipx_lzma_alone (archive_read_support_format_zip.c:1660) ==619== by 0x14EEAC: archive_read_format_zip_read_data (archive_read_support_format_zip.c:2670) ==619== by 0x1219BB: archive_read_data_into_fd (archive_read_data_into_fd.c:101) ==619== by 0x114D70: read_archive (read.c:369) ==619== by 0x1153F6: tar_mode_x (read.c:112) ==619== by 0x113A3F: main (bsdtar.c:880) ==619== ==619== LEAK SUMMARY: ==619== definitely lost: 96 bytes in 1 blocks ==619== indirectly lost: 224 bytes in 1 blocks ==619== possibly lost: 0 bytes in 0 blocks ==619== still reachable: 76 bytes in 2 blocks ==619== suppressed: 0 bytes in 0 blocks ==619== Reachable blocks (those to which a pointer was found) are not shown.,CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
(This can be done even with a single archive file.),CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
(This can be done even with a single archive file.),CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
(This can be done even with a single archive file.),CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
(This can be done even with a single archive file.),CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
\307q\005\bo\002\244\201\350\003\350\003libarchive/archive_read_support_format_tar.c:612:10: runtime error: signed integer overflow: 9223372036854775807 + 1 cannot be represented in type 'long'.,CVE-2015-8933,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
#ERROR!,CVE-2016-8687,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
#ERROR!,CVE-2017-14166,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
#ERROR!,CVE-2019-11463,3,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0
#ERROR!,CVE-2020-21674,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
#ERROR!,CVE-2016-8689,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
#ERROR!,CVE-2015-8927,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
#ERROR!,CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
#ERROR!,CVE-2016-8687,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
#ERROR!,CVE-2019-1000019,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
> Undefined behavior / signed integer overflow in TAR parser.,CVE-2015-8933,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
7zip: fix crash when parsing certain archives.,CVE-2019-1000019,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
A 32-byte reproducer input is attached: input.zip.,CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
A crafted file causes an heap overflow in the read_Header function in the 7zip parser.,CVE-2016-8689,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
A memory leak in archive_read_format_zip_cleanup in archive_read_support_format_zip.c in libarchive 3.3.4-dev allows remote attackers to cause a denial of service via a crafted ZIP file because of a HAVE_LZMA_H typo.,CVE-2019-11463,3,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0
"A RAR file with an invalid zero dictionary size was not being rejected, leading to a zero-sized allocation for the dictionary storage which was then overwritten during the dictionary initialization.",CVE-2016-4302,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"A simple cast suffices to fix this since the base location is always 32 bits for ISO, so multiplying by the sector size will never overflow a 64-bit integer.",CVE-2016-5844,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
A specially crafted archive can use this to cause a crash.,CVE-2019-1000019,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Address Sanitizer trace: ==30882==ERROR: AddressSanitizer: stack-buffer-underflow on address 0x7ffff58ae12f at pc 0x4df51b bp 0x7ffff58ae0d0 sp 0x7ffff58ae0c0 READ of size 1 at 0x7ffff58ae12f thread T0 #0 0x4df51a in _ar_read_header libarchive/archive_read_support_format_ar.c:242 #1 0x4df51a in archive_read_format_ar_read_header libarchive/archive_read_support_format_ar.c:437 #2 0x46c4d2 in _archive_read_next_header2 libarchive/archive_read.c:645 #3 0x46c4d2 in _archive_read_next_header libarchive/archive_read.c:685 #4 0x41b0b2 in read_archive tar/read.c:252 #5 0x41d243 in tar_mode_x tar/read.c:104 #6 0x40d78f in main tar/bsdtar.c:805 #7 0x7fe341554f9f in __libc_start_main (/lib64/libc.so.6+0x1ff9f) #8 0x412d81 (/mnt/ram/libarchive/bsdtar+0x412d81) Full asan output attached.,CVE-2015-8920,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
After it got fuzzed by hanno and some other people (1 2 3)I decided to fuzz it too.,CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
After it got fuzzed by hanno and some other people (1 2 3)I decided to fuzz it too.,CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"An ASAN trace is below, but ASAN is not required - an uninstrumented binary will also crash.",CVE-2019-1000019,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
An error in the lha_read_file_header_1() function (archive_read_support_format_lha.c) in libarchive 3.2.2 allows remote attackers to trigger an out-of-bounds read memory access and subsequently cause a crash via a specially crafted archive.,CVE-2017-5601,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"archive_acl_from_text_l (acl=<optimised out>, text=0x7e2e92 """", want_type=<optimised out>, sc=<optimised out>) at libarchive/archive_acl.c:1726 1726 switch (*s) { (gdb) p n $1 = 1 (gdb) p field[n] $2 = {start = 0x0, end = 0x0}.",CVE-2018-1000879,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
archive_strncat_l(): allocate and do not convert if length == 0.,CVE-2016-10209,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
as->s[as->length] = '\0'; // **Heap overflow** occurs as it tries to write beyond the allocated heap memory.,CVE-2020-21674,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
array subscript is above array bounds,CVE-2016-4301,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Avoid a double-free when a window size of 0 is specified.,CVE-2018-1000877,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
Avoid a read off-by-one error for UTF16 names in RAR archives.,CVE-2017-14502,3,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0
Basic Information: versions of libarchive: 3.4.1dev How you obtained it: built from source libarchive-3.4.1dev (https://github.com/libarchive/libarchive) Tested OS: Linux 5.0.0-37-generic x86_64 Tested compiler version : gcc version 7.4.0 What other files were involved?,CVE-2020-21674,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Both reads and writes to the freed region can be observed.,CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
bsdtar in libarchive before 3.2.0 allows remote attackers to cause a denial of service (infinite loop) via an ISO with a directory that is a member of itself.,CVE-2015-8930,3,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0
"bsdtar: An error in archive_string_append_from_wcs() (archive_string.c) triggers an out-of-bounds write in heap memory that results into a crash, via a specially crafted archive file.",CVE-2020-21674,3,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0
"but only a few hundred bytes of data, causes a quasi-infinite loop.",CVE-2018-1000880,3,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0
"by checking rar->cursor, we have to prevent ourselves from ever ending up there.",CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Consume data in subsequent calls to _warc_read.,CVE-2018-1000880,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"Crash analysis : In archive_string_append_from_wcs() (archive_string.c), upon execution of the crashing input (crash-file): archive_string_append_from_wcs(){ .... // Allocated heap memory for as->s is 72 bytes in range (0x607000000250,0x607000000298) p = as->s + as->length; ... while (*w != L'\0' && len > 0) { ... #if HAVE_WCRTOMB n = wcrtomb(p, *w++, &shift_state); // p = 0x611000000628 --> 0x00, wcrtomb() returns 3, n = 3 #else n = wctomb(p, *w++); #endif if (n == -1) { if (errno == EILSEQ) { ... } else p += n; // p = 0x611000000628 --> 0x00 len--; } as->length = p - as->s; // as->length = 72. as->s[as->length] = '\0'; // **Heap overflow** occurs as it tries to write beyond the allocated heap memory.",CVE-2020-21674,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Crash Type: Heap-buffer-overflow READ {*},CVE-2017-14502,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1
Crash Type: Heap-buffer-overflow READ {*} Crash Address: 0x6140000009f8 Crash State: read_header archive_read_format_rar_read_header _archive_read_next_header2 Sanitizer: address (ASAN) Recommended Security Severity: Medium Package: libarchive13 Version: 3.2.2-3.1 $ valgrind --quiet -- bsdtar -xf oob.rar ==1880== Invalid read of size 1 ==1880== at 0x4832FF0: memcpy (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so) ==1880== by 0x489B5E0: memcpy (string3.h:53) ==1880== by 0x489B5E0: read_header (archive_read_support_format_rar.c:1577) ==1880== by 0x489C347: archive_read_format_rar_read_header (archive_read_support_format_rar.c:932) ==1880== by 0x4873A54: _archive_read_next_header2 (archive_read.c:649) ==1880== by 0x4873B5B: _archive_read_next_header (archive_read.c:687) ==1880== by 0x10D384: read_archive (read.c:261) ==1880== by 0x10DCAC: tar_mode_x (read.c:112) ==1880== by 0x10C2BB: main (bsdtar.c:809) ==1880== Address 0x6ca726a is 0 bytes after a block of size 98 alloc'd ==1880== at 0x482E1FC: malloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so) ==1880== by 0x4830520: realloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so) ==1880== by 0x489B451: read_header (archive_read_support_format_rar.c:1423) ==1880== by 0x489C347: archive_read_format_rar_read_header (archive_read_support_format_rar.c:932) ==1880== by 0x4873A54: _archive_read_next_header2 (archive_read.c:649) ==1880== by 0x4873B5B: _archive_read_next_header (archive_read.c:687) ==1880== by 0x10D384: read_archive (read.c:261) ==1880== by 0x10DCAC: tar_mode_x (read.c:112) ==1880== by 0x10C2BB: main (bsdtar.c:809) ==1880== bsdtar: Unknown file attributes from RAR file's host OS bsdtar: Error exit delayed from previous errors.,CVE-2017-14502,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1
"Currently, it is possible to create an archive that crashes bsdtar with a malformed ACL: Program received signal SIGSEGV, Segmentation fault.",CVE-2018-1000879,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Description: libarchive is a multi-format archive and compression library.,CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
detected memory leaks,CVE-2019-11463,3,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0
Direct leak of 96 byte(s) in 1 object(s) allocated from: #0 0x7f4c0b1dfb50 in __interceptor_malloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xdeb50) #1 0x7f4c0a85dced (/lib/x86_64-linux-gnu/liblzma.so.5+0x2ced) Indirect leak of 224 byte(s) in 1 object(s) allocated from: #0 0x7f4c0b1dfb50 in __interceptor_malloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xdeb50) #1 0x7f4c0a864274 (/lib/x86_64-linux-gnu/liblzma.so.5+0x9274) SUMMARY: AddressSanitizer: 320 byte(s) leaked in 2 allocation(s).,CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Do not extract this zip file -- it is the fuzzed input itself.,CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Do something sensible for empty strings to make fuzzers happy.,CVE-2017-14166,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Fail if entry is too small for encryption header.,CVE-2015-8927,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Fail with negative lha->compsize in lha_read_file_header_1().,CVE-2017-5601,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Fix a possible heap-buffer-overflow in archive_string_append_from_wcs().,CVE-2020-21674,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Fix integer overflow when computing location of volume descriptor,CVE-2016-5844,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Fix integer overflow when computing location of volume descriptor.,CVE-2016-5844,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Fix libarchive/archive_read_support_format_mtree.c:1388:11: error: array subscript is above array bounds.,CVE-2016-4301,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Fix typo in preprocessor macro in archive_read_format_zip_cleanup().,CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Fixes a heap buffer overflow reported in Secunia SA74169.,CVE-2017-5601,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"For the test driver in the gist, I see the output: entry name: a Error reading data: Invalid lzma data ================================================================= ==27645==ERROR: LeakSanitizer: detected memory leaks ...",CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"Found with a combination of AFL, afl-rb and qsym.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"Found with a setup running AFL, afl-rb, and qsym.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Found with american fuzzy lop.,CVE-2015-8927,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Found with an AFL + afl-rb + qsym setup.,CVE-2018-1000880,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Frees lzma_stream on cleanup().,CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Fuzzing uncovered some UAF and memory overrun bugs where a file in a single file archive reported that it was split across multiple volumes.,CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Fuzzing with CRCs disabled revealed that a call to get_uncompressed_data() would sometimes fail to return at least 'minimum' bytes.,CVE-2019-1000019,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Github Issue #522: Detect cycles in the ISO directory tree.,CVE-2015-8930,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"have found some hangs, crashes and memory corruption issues in libarchive.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Heap-based buffer overflow in archive_string_append_from_wcs() (archive_string.c) in libarchive-3.4.1dev allows remote attackers to cause a denial of service (out-of-bounds write in heap memory resulting into a crash) via a crafted archive file.,CVE-2020-21674,3,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0
Heap-based buffer overflow in the parse_codes function in archive_read_support_format_rar.c in libarchive before 3.2.1 allows remote attackers to execute arbitrary code via a RAR file with a zero-sized dictionary.,CVE-2016-4302,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Heap-based buffer overflow in the zip_read_mac_metadata function in archive_read_support_format_zip.c in libarchive before 3.2.0 allows remote attackers to execute arbitrary code via crafted entry-size values in a ZIP archive.,CVE-2016-1541,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Here's the crash dump.,CVE-2015-8933,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"However, because the ppmd7 decoder wasn't actually done with the buffer, it would continue to used the freed buffer.",CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
https://crashes.fuzzing-project.org/libarchive-undefined-signed-overflow.tar.,CVE-2015-8933,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"I am pretty sure this is the bug mentioned in the qsym paper [1], and I was able to replicate it with a qsym + AFL + afl-rb setup.",CVE-2018-1000879,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"I have found some hangs, crashes and memory corruption issues in libarchive.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"I have found some hangs, crashes and memory corruption issues in libarchive.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"I have found some hangs, crashes and memory corruption issues in libarchive.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"I suppose the cpio code could sanity-check the symlink size and return ARCHIVE_FATAL in this case without even trying to read it, but that would be a fairly minor improvement.",CVE-2016-4809,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"I tried writing my own driver based on the tutorials in the wiki (see this gist), and the leak remains even after calling archive_read_free().",CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ibarchive: heap-based buffer overflow in xml_data (archive_read_support_format_xar.c).,CVE-2017-14166,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"If a 7-Zip archive declares a rediculously large number of substreams, it can overflow an internal counter, leading a subsequent memory allocation to be too small for the substream data.",CVE-2016-4300,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"If an OS X metadata entry is stored without compression, abort the entire archive if the compressed and uncompressed data sizes do not match.",CVE-2016-1541,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Integer overflow in the archive_read_format_tar_skip function in archive_read_support_format_tar.c in libarchive before 3.2.0 allows remote attackers to cause a denial of service (crash) via a crafted tar file.,CVE-2015-8933,3,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0
Integer overflow in the ISO parser in libarchive before 3.2.1 allows remote attackers to cause a denial of service (application crash) via a crafted ISO file.,CVE-2016-5844,3,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0
"Integer overflow in the read_SubStreamsInfo function in archive_read_support_format_7zip.c in libarchive before 3.2.1 allows remote attackers to execute arbitrary code via a 7zip file with a large number of substreams, which triggers a heap-based buffer overflow.",CVE-2016-4300,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"Integer signedness error in the archive_write_zip_data function in archive_write_set_format_zip.c in libarchive 3.1.2 and earlier, when running on 64-bit machines, allows context-dependent attackers to cause a denial of service (crash) via unspecified vectors, which triggers an improper conversion between unsigned and signed types, leading to a buffer overflow.",CVE-2013-0211,3,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0
Issue #523: Fail if entry is too small for encryption header.,CVE-2015-8927,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"Issue #582: reject sparse blocks with negative size or offset, detect overflow when tracking sparse blocks.",CVE-2015-8933,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Issue #767: Buffer overflow printing a filename.,CVE-2016-8687,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Issue 403: Buffer underflow parsing 'ar' header.,CVE-2015-8920,3,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0
Issue 761: Heap overflow reading corrupted 7Zip files.,CVE-2016-8689,3,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0
It's better to abort on a damaged file than risk reading garbage.,CVE-2015-8920,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
I've encountered a memory leak while fuzzing libarchive.,CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0
I've looked through the surrounding code and it looks like libarchive correctly handles the malloc() failure in this case.,CVE-2016-4809,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"I've not been able to reproduce this, but have expanded the conversion buffer to 128 bytes on the belief that no multibyte character set has a single character of more than 32 bytes.",CVE-2016-8687,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"libarchive 3.3.2 allows remote attackers to cause a denial of service (xml_data heap-based buffer over-read and application crash) via a crafted xar archive, related to the mishandling of empty strings in the atol8 function in archive_read_support_format_xar.c.",CVE-2017-14166,3,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0
"libarchive version commit 379867ecb330b3a952fb7bfa7bffb7bbd5547205 onwards (release v3.3.0 onwards) contains a CWE-476: NULL Pointer Dereference vulnerability in ACL parser - libarchive/archive_acl.c, archive_acl_from_text_l() that can result in Crash/DoS.",CVE-2018-1000879,3,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
"libarchive version commit 416694915449219d505531b1096384f3237dd6cc onwards (release v3.1.0 onwards) contains a CWE-415: Double Free vulnerability in RAR decoder - libarchive/archive_read_support_format_rar.c, parse_codes(), realloc(rar->lzss.window, new_size) with new_size = 0 that can result in Crash/DoS.",CVE-2018-1000877,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
libarchive version commit 416694915449219d505531b1096384f3237dd6cc onwards (release v3.1.0 onwards) contains a CWE-416: Use After Free vulnerability in RAR decoder - libarchive/archive_read_support_format_rar.c that can result in Crash/DoS - it is unknown if RCE is possible.,CVE-2018-1000878,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
"libarchive version commit 9693801580c0cf7c70e862d305270a16b52826a7 onwards (release v3.2.0 onwards) contains a CWE-20: Improper Input Validation vulnerability in WARC parser - libarchive/archive_read_support_format_warc.c, _warc_read() that can result in DoS - quasi-infinite run time and disk usage from tiny file.",CVE-2018-1000880,3,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"libarchive version commit bf9aec176c6748f0ee7a678c5f9f9555b9a757c1 onwards (release v3.0.2 onwards) contains a CWE-125: Out-of-bounds Read vulnerability in 7zip decompression, archive_read_support_format_7zip.c, header_bytes() that can result in a crash (denial of service).",CVE-2019-1000019,3,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
libarchive: bsdtar: heap-based buffer overflow in read_Header (archive_read_support_format_7zip.c).,CVE-2016-8689,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
libarchive: bsdtar: stack-based buffer overflow in bsdtar_expand_char (util.c).,CVE-2016-8687,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Limit write requests to at most INT_MAX.,CVE-2013-0211,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
malloc() fails here when trying to allocate memory to contain the entire symlink.,CVE-2016-4809,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Memory leak when decoding LZMA #1165.,CVE-2019-11463,3,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0
"My gut feeling is that someone more skilled than I could cause arbitrary code execution with this, but I cannot say for certain.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"My gut feeling is that someone more skilled than I could cause arbitrary code execution with this, but I cannot say for certain.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"My gut feeling is that someone more skilled than I could cause arbitrary code execution with this, but I cannot say for certain.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"My gut feeling is that someone more skilled than I could cause arbitrary code execution with this, but I cannot say for certain.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
new_size can be 0 with a malicious or corrupted RAR archive.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"No doubt, this will require additional tuning in the future.",CVE-2015-8920,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Note that calling archive_read_free() does not free this memory.,CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NOTE: this only affects users who downloaded the development code from GitHub.,CVE-2020-21674,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"o, when we are in the dangerous part or rar_read_ahead that assumes a valid split, we set a flag force read_header to either go down the path for split files or bail.",CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Original issue 403 created by Google Code user hanno@hboeck.de on 2015-02-07T11:14:08.000Z: bsdtar -xf bsdtar-invalid-read-stack.a will segfault.,CVE-2015-8920,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Original issue 415 created by Google Code user hanno@hboeck.de on 2015-03-06T11:03:58.000Z: bsdtar will detect the attached zip file as password protected.,CVE-2015-8927,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"Posted on September 11, 2016 by ago Description: libarchive is a multi-format archive and compression library.",CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"Posted on September 11, 2016 by ago Description: libarchive is a multi-format archive and compression library.",CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
rar: file split across multi-part archives must match.,CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"READ of size 1 at 0x60200000ecbb thread T0 #0 0x7f01eb0e55fb in read_Header /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/libarchive/archive_read_support_format_7zip.c:2601:9 #1 0x7f01eb0e55fb in slurp_central_directory /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/libarchive/archive_read_support_format_7zip.c:2923 #2 0x7f01eb0e55fb in archive_read_format_7zip_read_header /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/libarchive/archive_read_support_format_7zip.c:638 #3 0x7f01eb07a0ec in _archive_read_next_header2 /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/libarchive/archive_read.c:649:7 #4 0x7f01eb079c8f in _archive_read_next_header /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/libarchive/archive_read.c:687:8 #5 0x5021cb in read_archive /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/tar/read.c:261:7 #6 0x501473 in tar_mode_t /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/tar/read.c:94:2 #7 0x4f8929 in main /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/tar/bsdtar.c:803:3 #8 0x7f01ea0df61f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.22-r4/work/glibc-2.22/csu/libc-start.c:289 #9 0x41b778 in _init (/usr/bin/bsdtar+0x41b778) 0x60200000ecbb is located 0 bytes to the right of 11-byte region [0x60200000ecb0,0x60200000ecbb) allocated by thread T0 here: #0 0x4c2e50 in calloc /var/tmp/portage/sys-devel/llvm-3.8.0-r3/work/llvm-3.8.0.src/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:66 #1 0x7f01eb0dead3 in read_Header /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/libarchive/archive_read_support_format_7zip.c:2454:24 #2 0x7f01eb0dead3 in slurp_central_directory /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/libarchive/archive_read_support_format_7zip.c:2923 #3 0x7f01eb0dead3 in archive_read_format_7zip_read_header /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/libarchive/archive_read_support_format_7zip.c:638 #4 0x7f01eb07a0ec in _archive_read_next_header2 /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/libarchive/archive_read.c:649:7 #5 0x7f01eb079c8f in _archive_read_next_header /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/libarchive/archive_read.c:687:8 #6 0x501473 in tar_mode_t /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/tar/read.c:94:2 #7 0x4f8929 in main /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/tar/bsdtar.c:803:3 #8 0x7f01ea0df61f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.22-r4/work/glibc-2.22/csu/libc-start.c:289",CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"READ of size 1 at 0x631000010800 thread T0 #0 0x6169dc in trad_enc_decrypt_update libarchive/archive_read_support_format_zip.c:251 #1 0x6169dc in zip_read_data_none libarchive/archive_read_support_format_zip.c:1159 #2 0x6169dc in archive_read_format_zip_read_data libarchive/archive_read_support_format_zip.c:1797 #3 0x4a342d in copy_data libarchive/archive_read_extract2.c:139 #4 0x4a342d in archive_read_extract2 libarchive/archive_read_extract2.c:101 #5 0x41c088 in read_archive tar/read.c:361 #6 0x41d3ab in tar_mode_x tar/read.c:104 #7 0x40d4d9 in main tar/bsdtar.c:805 #8 0x7f83a55e6f9f in __libc_start_main (/lib64/libc.so.6+0x1ff9f) #9 0x412d3c (/data/fuzzretest/bsdtar+0x412d3c) 0x631000010800 is located 0 bytes to the right of 65536-byte region [0x631000000800,0x631000010800) allocated by thread T0 here: #0 0x7f83a70cf6f7 in malloc (/usr/lib/gcc/x86_64-pc-linux-gnu/4.9.2/libasan.so.1+0x576f7) #1 0x4a648c in file_open libarchive/archive_read_open_filename.c:358",CVE-2015-8927,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"read_header in archive_read_support_format_rar.c in libarchive 3.3.2 suffers from an off-by-one error for UTF-16 names in RAR archives, leading to an out-of-bounds read in archive_read_format_rar_read_header.",CVE-2017-14502,3,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0
"realloc(area, 0) is equivalent to free(area), so the region would be free()d here and the free()d again in the cleanup function.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Reject cpio symlinks that exceed 1MB.,CVE-2016-4809,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Resolves possible null-pointer dereference reported by OSS-Fuzz.,CVE-2016-10209,3,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
return (ret_val); },CVE-2020-21674,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Signed integer overflows are undefined in C.,CVE-2015-8933,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Signed integer overflows are undefined in C.,CVE-2015-8933,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Signed integer overflows are undefined in C. This can be seen by compiling libarchive with -fsanitize=undefined.,CVE-2015-8933,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
SIGSEGV in archive_wstring_append_from_mbs() Tested on Git HEAD: 54546be Payload: https://frankowicz.me/storage/crashes/la_segv_archive_wstring_append_from_mbs To reproduce: bsdtar -t -f la_segv_archive_wstring_append_from_mbs ASAN Output: ==1002==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x0000005fb3cc bp 0x7ffc5999dae0 sp 0x7ffc5999daa0 T0) #0 0x5fb3cb in archive_wstring_append_from_mbs libarchive/archive_string.c:603 #1 0x60363a in archive_mstring_get_wcs libarchive/archive_string.c:3929 #2 0x42a1c4 in archive_entry_pathname_w libarchive/archive_entry.c:580 #3 0x5bfee9 in zip_read_local_file_header libarchive/archive_read_support_format_zip.c:871 #4 0x5c2b1d in archive_read_format_zip_streamable_read_header libarchive/archive_read_support_format_zip.c:2149 #5 0x45841b in _archive_read_next_header2 libarchive/archive_read.c:648 #6 0x45841b in _archive_read_next_header libarchive/archive_read.c:686 #7 0x41280f in read_archive tar/read.c:261 #8 0x414b06 in tar_mode_t tar/read.c:94 #9 0x40963f in main tar/bsdtar.c:803 #10 0x7fb92a6f482f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f) #11 0x40c3e8 in _start (/usr/local/bin/bsdtar+0x40c3e8) AddressSanitizer can not provide additional info.,CVE-2016-10209,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"Since the compressed and uncompressed sizes are provided by data in the archive itself, an attacker could manipulate these values to write data beyond the end of the allocated buffer.",CVE-2016-1541,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Skip 0-length ACL fields.,CVE-2018-1000879,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
So we can't detect after the fact that we're in an invalid state - e.g.,CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"So, when we are in the dangerous part or rar_read_ahead that assumes a valid split, we set a flag force read_header to either go down the path for split files or bail.",CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Some early corpus entries may have been generated by qsym.,CVE-2019-1000019,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Stack out of bounds read in ar parser.,CVE-2015-8920,3,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0
Stack-based buffer overflow in the parse_device function in archive_read_support_format_mtree.c in libarchive before 3.2.1 allows remote attackers to execute arbitrary code via a crafted mtree file.,CVE-2016-4301,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Stack-based buffer overflow in the safe_fprintf function in tar/util.c in libarchive 3.2.1 allows remote attackers to cause a denial of service via a crafted non-printable multibyte character in a filename.,CVE-2016-8687,3,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0
Stop this by checking that the length is not zero before beginning the switch statement.,CVE-2018-1000879,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
SUMMARY: AddressSanitizer: SEGV libarchive/archive_string.c:603 ```archive_wstring_append_from_mbs ==1002==ABORTING,CVE-2016-10209,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
that archive_mstring_copy_mbs_len_l() does not set aes_set = AES_SET_MBS with aes_mbs.s == NULL.,CVE-2016-10209,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"That would check the new file name against the old file name, and if they didn't match up it would free the ppmd7 buffer and allocate a new one.",CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
The _ar_read_header function in archive_read_support_format_ar.c in libarchive before 3.2.0 allows remote attackers to cause a denial of service (out-of-bounds stack read) via a crafted ar file.,CVE-2015-8920,3,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
The archive_read_format_cpio_read_header function in archive_read_support_format_cpio.c in libarchive before 3.2.1 allows remote attackers to cause a denial of service (application crash) via a CPIO archive with a large symlink.,CVE-2016-4809,3,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0
The archive_wstring_append_from_mbs function in archive_string.c in libarchive 3.2.2 allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via a crafted archive file.,CVE-2016-10209,3,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0
"The bug is now not anymore reachable through the provided testcase, but I asked to make a new release to launch the fuzzer again.",CVE-2016-8687,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
The code can be made to read and write to a previously freed ppmd buffer by tricking the read-ahead code around multi-part archives.,CVE-2018-1000877,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
The code can be made to read and write to a previously freed ppmd buffer by tricking the read-ahead code around multi-part archives.,CVE-2018-1000877,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
The code can be made to read and write to a previously freed ppmd buffer by tricking the read-ahead code around multi-part archives.,CVE-2018-1000877,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
The code can be made to read and write to a previously freed ppmd buffer by tricking the read-ahead code around multi-part archives.,CVE-2018-1000877,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
The complete ASan output of the issue: # bsdtar -t -f $FILE ==13144==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x631000038800 at pc 0x7fb1c808f650 bp 0x7ffdd1b40990 sp 0x7ffdd1b40988 READ of size 1 at 0x631000038800 thread T0 #0 0x7fb1c808f64f in xml_data /var/tmp/portage/app-arch/libarchive-3.3.2/work/libarchive-3.3.2/libarchive/archive_read_support_format_xar.c #1 0x7fb1c808f64f in expat_data_cb /var/tmp/portage/app-arch/libarchive-3.3.2/work/libarchive-3.3.2/libarchive/archive_read_support_format_xar.c:3230 #2 0x7fb1c697c3b6 in _init /var/tmp/portage/dev-libs/expat-2.2.1/work/expat-2.2.1/lib/xmlparse.c:2960 #3 0x7fb1c697cb9b in _init /var/tmp/portage/dev-libs/expat-2.2.1/work/expat-2.2.1/lib/xmlparse.c:2418 #4 0x7fb1c697e988 in _init /var/tmp/portage/dev-libs/expat-2.2.1/work/expat-2.2.1/lib/xmlparse.c:4366 #5 0x7fb1c697f137 in _init /var/tmp/portage/dev-libs/expat-2.2.1/work/expat-2.2.1/lib/xmlparse.c:4089 #6 0x7fb1c6980fc7 in XML_ParseBuffer /var/tmp/portage/dev-libs/expat-2.2.1/work/expat-2.2.1/lib/xmlparse.c:1915 #7 0x7fb1c807d62a in expat_read_toc /var/tmp/portage/app-arch/libarchive-3.3.2/work/libarchive-3.3.2/libarchive/archive_read_support_format_xar.c:3273:8 #8 0x7fb1c807d62a in read_toc /var/tmp/portage/app-arch/libarchive-3.3.2/work/libarchive-3.3.2/libarchive/archive_read_support_format_xar.c:584 #9 0x7fb1c807d62a in xar_read_header /var/tmp/portage/app-arch/libarchive-3.3.2/work/libarchive-3.3.2/libarchive/archive_read_support_format_xar.c:677 #10 0x7fb1c7f728ed in _archive_read_next_header2 /var/tmp/portage/app-arch/libarchive-3.3.2/work/libarchive-3.3.2/libarchive/archive_read.c:648:7 #11 0x7fb1c7f72590 in _archive_read_next_header /var/tmp/portage/app-arch/libarchive-3.3.2/work/libarchive-3.3.2/libarchive/archive_read.c:686:8 #12 0x51483f in read_archive /var/tmp/portage/app-arch/libarchive-3.3.2/work/libarchive-3.3.2/tar/read.c:260:7 #13 0x513d89 in tar_mode_t /var/tmp/portage/app-arch/libarchive-3.3.2/work/libarchive-3.3.2/tar/read.c:94:2 #14 0x50eaae in main /var/tmp/portage/app-arch/libarchive-3.3.2/work/libarchive-3.3.2/tar/bsdtar.c:858:3 #15 0x7fb1c6ffe680 in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.23-r4/work/glibc-2.23/csu/../csu/libc-start.c:289 #16 0x41c628 in _init (/usr/bin/bsdtar+0x41c628),CVE-2017-14166,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"The complete ASan output: # bsdtar -t -f $FILE bsdtar: Missing type keyword in mtree specification 5!\\{bsdtar: Missing type keyword in mtree specification zO!\\{bsdtar: Missing type keyword in mtree specification zO\r\r\\{bsdtar: Missing type keyword in mtree specification zO\r\\w\200r\rbsdtar: Missing type keyword in mtree specification @;\r\005@{bsdtar: Missing type keyword in mtree specification zO\r\r\\{bsdtar: Malformed attribute """" (-51) z\f\fbsdtar: Missing type keyword in mtree specification h\352*((-.I,\002:%1=\037\257:B\362\020\217(\300\351!\002\341\341\341*(\244\244\263\377\377\377\377\244\377\177\244\244\244\244\244\244\244\264\244\244\244\244\244\244\244\244\244\244\244\244\244\244\244\244\244\244\244\244\244\244\244\244\244\036\036\036\036\036\036\036\036\036\036bsdtar: Missing type keyword in mtree specification =================================================================.",CVE-2016-8687,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
The complete ASan output: # bsdtar -t -f $FILE.,CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"The first (patch 1) is a double-free via a realloc(area, 0).",CVE-2018-1000877,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
"The first (patch 1) is a double-free via a realloc(area, 0).",CVE-2018-1000877,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
"The first (patch 1) is a double-free via a realloc(area, 0).",CVE-2018-1000877,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
"The first (patch 1) is a double-free via a realloc(area, 0).",CVE-2018-1000877,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
"The first one ended up being used to calculate certain statistics, then was overwritten by the second which was incompatible with those statistics.",CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
The fix here is to reject any header with multiple EmptyStream attributes.,CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"The last of this batch is a quasi-infinite loop in the warc code (patch 4), where data isn't consumed after being written out, so a large Content-Length can be used to consume almost limitless time and space, leading to a DoS condition.",CVE-2018-1000877,3,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0
"The last of this batch is a quasi-infinite loop in the warc code (patch 4), where data isn't consumed after being written out, so a large Content-Length can be used to consume almost limitless time and space, leading to a DoS condition.",CVE-2018-1000877,3,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0
"The last of this batch is a quasi-infinite loop in the warc code (patch 4), where data isn't consumed after being written out, so a large Content-Length can be used to consume almost limitless time and space, leading to a DoS condition.",CVE-2018-1000877,3,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0
"The last of this batch is a quasi-infinite loop in the warc code (patch 4), where data isn't consumed after being written out, so a large Content-Length can be used to consume almost limitless time and space, leading to a DoS condition.",CVE-2018-1000877,3,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0
The multiplication here defaulted to 'int' but calculations of file positions should always use int64_t.,CVE-2016-5844,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
The read_Header function in archive_read_support_format_7zip.c in libarchive 3.2.1 allows remote attackers to cause a denial of service (out-of-bounds read) via multiple EmptyStream attributes in a header in a 7zip archive.,CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"The safe_fprintf function attempts to ensure clean output for an arbitrary sequence of bytes by doing a trial conversion of the multibyte characters to wide characters -- if the resulting wide character is printable then we pass through the corresponding bytes unaltered, otherwise, we convert them to C-style ASCII escapes.",CVE-2016-8687,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
The sample file that demonstrated this had multiple 'EmptyStream' attributes.,CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
The second (patch 2) is memory corruption which seems to arise in ppmd7 decoding.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
The second (patch 2) is memory corruption which seems to arise in ppmd7 decoding.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
The second (patch 2) is memory corruption which seems to arise in ppmd7 decoding.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
The second (patch 2) is memory corruption which seems to arise in ppmd7 decoding.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
The stack trace in Issue #767 suggest that the 20-byte buffer was getting overflowed trying to format a non-printable multibyte character.,CVE-2016-8687,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"The trad_enc_decrypt_update function in archive_read_support_format_zip.c in libarchive before 3.2.0 allows remote attackers to cause a denial of service (out-of-bounds heap read and crash) via a crafted zip file, related to reading the password.",CVE-2015-8927,3,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"The warc decoder only used read ahead, it wouldn't actually consume data that had previously been printed.",CVE-2018-1000880,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
There is a crash in ACL parsing for tar archives (patch 3).,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
There is a crash in ACL parsing for tar archives (patch 3).,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
There is a crash in ACL parsing for tar archives (patch 3).,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
There is a crash in ACL parsing for tar archives (patch 3).,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"These were found with a combination of AFL, afl-rb and qsym.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"These were found with a combination of AFL, afl-rb and qsym.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"These were found with a combination of AFL, afl-rb and qsym.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"These were found with a combination of AFL, afl-rb and qsym.",CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This attack appear to be exploitable via the victim must open a specially crafted archive file.,CVE-2018-1000879,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This attack appear to be exploitable via the victim must open a specially crafted RAR archive.,CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This attack appear to be exploitable via the victim must open a specially crafted WARC file.,CVE-2018-1000880,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This attack appears to be exploitable via the victim opening a specially crafted 7zip file.,CVE-2019-1000019,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This bug comes out after 5 days of fuzzing and when AFL reports that it already made 15 cycles.,CVE-2016-8687,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This bug was found using our custom fuzzer.,CVE-2020-21674,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This can cause the crc32() invocation in header_bytes to read off into invalid memory.,CVE-2019-1000019,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This ensures e.g.,CVE-2016-10209,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This fix provides three new checks to guard against such manipulation and to make libarchive generally more robust when handling this type of entry.,CVE-2016-1541,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This is a simple NULL dereference leading to a crash.,CVE-2018-1000877,3,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
This is a simple NULL dereference leading to a crash.,CVE-2018-1000877,3,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
This is a simple NULL dereference leading to a crash.,CVE-2018-1000877,3,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
This is a simple NULL dereference leading to a crash.,CVE-2018-1000877,3,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
"This is quite tricky to solve: once the buffer has been freed it is too late, as the ppmd7 decoder functions almost universally assume success - there's no way for ppmd_read to signal error, nor are there good ways for functions like Range_Normalise to propagate them.",CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This leads to a crash.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This leads to a crash.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This leads to a crash.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This leads to a crash.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This means that a WARC resource with e.g.,CVE-2018-1000880,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"This means that if you specify an invalid content length, it will just reprint the same data over and over and over again until it hits the desired length.",CVE-2018-1000880,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This means that in some cases is not enough do few hours of fuzzing and believe that there aren?????t more bugs????? A crafted file causes a stack-buffer overflow write.,CVE-2016-8687,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This means that the ppmd7 decoder keeps a valid buffer and just runs out of data.,CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This prevents a certain common programming error (passing -1 to write) from leading to other problems deeper in the library.,CVE-2013-0211,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This results in reading the byte before the filename on the stack.,CVE-2015-8920,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This should only happen if there is a valid multibyte character of more than 5 bytes that was unprintable.,CVE-2016-8687,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
This was caused by ppmd7 operations calling rar_br_fillup.,CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"This would invoke rar_read_ahead, which would in some situations invoke archive_read_format_rar_read_header.",CVE-2018-1000878,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"To reproduce, build latest libarchive with ASAN (clang -fsanitize=address) and run: $ ./bsdtar -xOf input.zip # bsdtar compiled with ASAN a: Invalid lzma data bsdtar: Error exit delayed from previous errors.",CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"To trigger the bug, use the the crash file (unzip crash-file.zip) crash-file.zip =============== Compile with address address sanitizer (-fsanitize=addrsan) Command to reproduce the bug: $ ./bsdtar -t -f crash-file Output (partial).",CVE-2020-21674,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Two are in the RAR decoder.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Two are in the RAR decoder.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Two are in the RAR decoder.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Two are in the RAR decoder.,CVE-2018-1000877,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"Upstream was not able to reproduce the issue, maybe different compiler and compiler options, so he committed the fix based on what the stacktrace printed.",CVE-2016-8687,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Users of the product's official releases are unaffected.,CVE-2020-21674,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"Using this malformed tar file with ""bsdtar -tf [input]"" will cause a signed integer overflow.",CVE-2015-8933,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
warc: consume data once read.,CVE-2018-1000880,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"When copying data into the allocated buffer, check the copy size against both the compressed entry size and uncompressed entry size.",CVE-2016-1541,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
When entering nothing (just press enter) it will cause an invalid memory read access.,CVE-2015-8927,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"When reading OS X metadata entries in Zip archives that were stored without compression, libarchive would use the uncompressed entry size to allocate a buffer but would use the compressed entry size to limit the amount of data copied into that buffer.",CVE-2016-1541,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"When sanity-checking the size of an OS X metadata entry, abort this entry if either the compressed or uncompressed size is larger than 4MB.",CVE-2016-1541,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"When we grow the archive_string buffer, we have to make sure it fits at least one maximum-sized multibyte character in the current locale and the null character.",CVE-2020-21674,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"While here, also reject headers with multiple EmptyFile, AntiFile, Name, or Attributes markers.",CVE-2016-8689,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"While here, change a number of ar format issues from WARN to FATAL.",CVE-2015-8920,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"While pruning trailing text from ar filenames, we did not check for an empty filename.",CVE-2015-8920,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"Without ASAN, this can also be reproduced using Valgrind: $ valgrind --leak-check=full ./bsdtar -xOf input.zip a: Invalid lzma data bsdtar: Error exit delayed from previous errors.",CVE-2019-11463,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
WRITE of size 4 at 0x7fae139bf660 thread T0 #0 0x4957db in vsprintf /var/tmp/portage/sys-devel/llvm-3.8.1/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:1128 #1 0x495912 in sprintf /var/tmp/portage/sys-devel/llvm-3.8.1/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:1159 #2 0x50ab22 in bsdtar_expand_char /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/tar/util.c:223:4 #3 0x509c47 in safe_fprintf /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/tar/util.c:174:21 #4 0x50307f in read_archive /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/tar/read.c:320:5 #5 0x501bf3 in tar_mode_t /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/tar/read.c:94:2 #6 0x4f8b9f in main /var/tmp/portage/app-arch/libarchive-3.2.1-r3/work/libarchive-3.2.1/tar/bsdtar.c:803:3 #7 0x7fae1780761f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.22-r4/work/glibc-2.22/csu/libc-start.c:289 #8 0x41b778 in _init (/usr/bin/bsdtar+0x41b778),CVE-2016-8687,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
